version: 2

sources:
  - name: raw_data
    schema: SF_SCHEMA
    database: SNOWFLAKE_DBT_DATA
    tables:
      - name: cust  #logical name 
        identifier: CUSTOMER  #actual table name 
      - name: sales
        identifier: sales_transactions
      - name : ord
        identifier: orders
      - name : supply_chain
        identifier: SUPPLY_CHAIN_ORDERS
  - name: prod_data
    schema: PROD_SCH
    database: SNOWFLAKE_DBT_DATA
    tables:
      - name: prod
        identifier: PRODUCT
      - name: del
        identifier: DELIVERY_STATUS_FACT
  - name: snowflake_dbt_data
    database: SNOWFLAKE_DBT_DATA
    schema: SF_SCHEMA
    tables:
      - name: TELECOM_CUSTOMERS_FRESHNESS
        identifier: TELECOM_CUSTOMERS
        freshness:
          warn_after: {count: 1, period: day}
          error_after: {count: 2, period: day}
        loaded_at_field: registered_on
      - name: telecom_customers_freshness2
        identifier: TELECOM_CUSTOMERS
        freshness: 
          error_after:
            count: 2
            period: hour
          warn_after:
            count: 1
            period: hour
        loaded_at_field: "convert_timezone('UTC',registered_on)"
      